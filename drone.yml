kind: pipeline
name: acrux_kernel_xiaomi_sdm660_ci

platform:
  os: linux
  arch: amd64

clone:
  depth: 1

steps:
  - name: beta_kernel
    image: ubuntu:latest
    environment:
      BOT_API_KEY:
        from_secret: BOT_API_KEY
      KERNELRELEASE: "Yuri"
    commands:
      - apt-get update && apt-get install -y bison build-essential bc bison curl libssl-dev git zip python
      - git clone https://github.com/nysascape/scriptsv2.git -b drone kernelscripts
      - source ./kernelscripts/envsetup.sh --gcc10
      - bash kernelscripts/drone.sh
    when:
      branch:
        exclude:
          - caf
          - meme-commits
          - sdm660-em
          - clean
